<!DOCTYPE html>
<html lang="en">

<head>
  <title>
  Code Coverage Isn&#39;t Everything · Steven Casagrande
</title>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="color-scheme" content="light dark">




<meta name="author" content="Steven Casagrande">
<meta name="description" content="Over the past few months, the people within my circle of friends (myself included) have started to put more of an emphasis on increasing the code coverage for their own projects. I&rsquo;d like to take a moment here how a code coverage metric is important, but it should not be the only goal when writing unit tests.
For those that are unaware, code coverage is simply a metric that measures the percentage of lines of code that are executed when your unit test framework is run. You can see an example coverage report at the Codecov page for InstrumentKit.">
<meta name="keywords" content="blog,developer,personal">
<meta name="fediverse:creator" content="" />


  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Code Coverage Isn&#39;t Everything">
  <meta name="twitter:description" content="Over the past few months, the people within my circle of friends (myself included) have started to put more of an emphasis on increasing the code coverage for their own projects. I’d like to take a moment here how a code coverage metric is important, but it should not be the only goal when writing unit tests.
For those that are unaware, code coverage is simply a metric that measures the percentage of lines of code that are executed when your unit test framework is run. You can see an example coverage report at the Codecov page for InstrumentKit.">

<meta property="og:url" content="https://steven.casagrande.io/posts/2016/code-coverage-isnt-everything/">
  <meta property="og:site_name" content="Steven Casagrande">
  <meta property="og:title" content="Code Coverage Isn&#39;t Everything">
  <meta property="og:description" content="Over the past few months, the people within my circle of friends (myself included) have started to put more of an emphasis on increasing the code coverage for their own projects. I’d like to take a moment here how a code coverage metric is important, but it should not be the only goal when writing unit tests.
For those that are unaware, code coverage is simply a metric that measures the percentage of lines of code that are executed when your unit test framework is run. You can see an example coverage report at the Codecov page for InstrumentKit.">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2016-04-16T00:00:00+00:00">
    <meta property="article:modified_time" content="2016-04-16T00:00:00+00:00">
    <meta property="article:tag" content="Testing">




<link rel="canonical" href="https://steven.casagrande.io/posts/2016/code-coverage-isnt-everything/">


<link rel="preload" href="/fonts/fa-brands-400.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="/fonts/fa-regular-400.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="/fonts/fa-solid-900.woff2" as="font" type="font/woff2" crossorigin>


  
  
  <link rel="stylesheet" href="/css/coder.min.07092c1350ffd254998dc43a44ae96e617d14af4df4602626878df89189c5e1a.css" integrity="sha256-BwksE1D/0lSZjcQ6RK6W5hfRSvTfRgJiaHjfiRicXho=" crossorigin="anonymous" media="screen" />






  
    
    
    <link rel="stylesheet" href="/css/coder-dark.min.a00e6364bacbc8266ad1cc81230774a1397198f8cfb7bcba29b7d6fcb54ce57f.css" integrity="sha256-oA5jZLrLyCZq0cyBIwd0oTlxmPjPt7y6KbfW/LVM5X8=" crossorigin="anonymous" media="screen" />
  



 




<link rel="icon" type="image/svg+xml" href="/images/favicon.svg" sizes="any">
<link rel="icon" type="image/png" href="/images/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/images/favicon-16x16.png" sizes="16x16">

<link rel="apple-touch-icon" href="/images/apple-touch-icon.png">
<link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">

<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/images/safari-pinned-tab.svg" color="#5bbad5">









</head>






<body class="preload-transitions colorscheme-dark">
  

  <main class="wrapper">
    <nav class="navigation">
  <section class="container">
    
    <a class="navigation-title" href="https://steven.casagrande.io/">
      Steven Casagrande
    </a>
    
    
      <input type="checkbox" id="menu-toggle" />
      <label class="menu-button float-right" for="menu-toggle">
        <i class="fa-solid fa-bars fa-fw" aria-hidden="true"></i>
      </label>
      <ul class="navigation-list">
        
          
            <li class="navigation-item">
              <a class="navigation-link " href="/posts/">Posts</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link " href="/categories/bazel">Bazel</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link " href="/about/">About</a>
            </li>
          
        
        
      </ul>
    
  </section>
</nav>


    <div class="content">
      
  <section class="container post">
    <article>
      <header>
        <div class="post-title">
          <h1 class="title">
            <a class="title-link" href="https://steven.casagrande.io/posts/2016/code-coverage-isnt-everything/">
              Code Coverage Isn&#39;t Everything
            </a>
          </h1>
        </div>
        <div class="post-meta">
          <div class="date">
            <span class="posted-on">
              <i class="fa-solid fa-calendar" aria-hidden="true"></i>
              <time datetime="2016-04-16T00:00:00Z">
                April 16, 2016
              </time>
            </span>
            <span class="reading-time">
              <i class="fa-solid fa-clock" aria-hidden="true"></i>
              2-minute read
            </span>
          </div>
          
          
          <div class="tags">
  <i class="fa-solid fa-tag" aria-hidden="true"></i>
    <span class="tag">
      <a href="/tags/testing/">Testing</a>
    </span></div>

        </div>
      </header>

      <div class="post-content">
        
        <p>Over the past few months, the people within my circle of friends (myself included) have started to put more of an emphasis on increasing the code coverage for their own projects. I&rsquo;d like to take a moment here how a code coverage metric is important, but it should not be the only goal when writing unit tests.</p>
<p>For those that are unaware, code coverage is simply a metric that measures the percentage of lines of code that are executed when your unit test framework is run. You can see an example coverage report at the <a href="https://app.codecov.io/gh/instrumentkit/InstrumentKit"  class="external-link" target="_blank" rel="noopener">Codecov page for InstrumentKit</a>.</p>
<p>Coverage is a great indicator that you are heading in the correct direction with your tests. After all, if a line of code is ran once in a test environment, that&rsquo;s better than zero! The problem arises when one assumes that is sufficient. The idea is that unit tests should capture all the behaviour of your code, not just touch each line once.</p>
<p>Alright, lets look at an example of what I&rsquo;m talking about. A great example is a function that uses ternary expressions (basic <code>if</code> statements compressed into a single line).</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">foobar</span>(value):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> value<span style="color:#f92672">.</span>lower() <span style="color:#66d9ef">if</span> isinstance(value, str) <span style="color:#66d9ef">else</span> value
</span></span></code></pre></div><p>All this function is doing is casting the input to lowercase if the input is a string, else it just returns the input. Not the most useful function in the world, but a good demonstration.</p>
<p>Now lets say our corresponding tests look like this:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">test_foobar</span>():
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">assert</span> foobar(<span style="color:#ae81ff">123</span>) <span style="color:#f92672">==</span> <span style="color:#ae81ff">123</span>
</span></span></code></pre></div><p>So now if we were to check our code coverage, we&rsquo;d see that we have 100%! Wow great job! But wait&hellip;we haven&rsquo;t actually captured all the behaviour. Someone in the future could change our <code>foobar</code> function to call <code>str.upper()</code>, or not do anything with strings at all. We need some more tests.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">test_foobar_integer</span>():
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">assert</span> foobar(<span style="color:#ae81ff">123</span>) <span style="color:#f92672">==</span> <span style="color:#ae81ff">123</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">test_foobar_lower_case_string</span>():
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">assert</span> foobar(<span style="color:#e6db74">&#34;abc&#34;</span>) <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;abc&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">test_foobar_casts_to_lower</span>():
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">assert</span> foobar(<span style="color:#e6db74">&#34;AbCd&#34;</span>) <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;abcd&#34;</span>
</span></span></code></pre></div><p>There we go, much better. Even though our code coverage hasn&rsquo;t changed, our tests are in a much better shape. Naturally we can keep adding more (what&rsquo;s the desired behaviour with lists of strings? What about byte strings?) but to show my point this is sufficient.</p>
<p>Now, this would have been much less of a problem if we had followed Test Driven Development (basically write tests before you write your implementation, and yes this is a huge oversimplification of TDD). But because we&rsquo;re trying to add tests to an existing project after its already been written, we don&rsquo;t get that privilege.</p>

      </div>


      <footer>
        


        
        
        
        
        

        
        
      </footer>
    </article>

    
  </section>

    </div>

    <footer class="footer">
  <section class="container">
    ©
    
    2024
     Steven Casagrande 
    ·
    
    Powered by <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> & <a href="https://github.com/luizdepra/hugo-coder/" target="_blank" rel="noopener">Coder</a>.
    
  </section>
</footer>

  </main>

  

  
  
  <script src="/js/coder.min.6ae284be93d2d19dad1f02b0039508d9aab3180a12a06dcc71b0b0ef7825a317.js" integrity="sha256-auKEvpPS0Z2tHwKwA5UI2aqzGAoSoG3McbCw73gloxc="></script>
  

  

  


  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  
</body>

</html>
